<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2048 - WebArcade</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #faf8ef;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.container {
  text-align: center;
  position: relative;
}

.top-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.title {
  font-size: 32px;
  font-weight: bold;
  color: #776e65;
}

.score {
  background: #bbada0;
  color: #fff;
  padding: 10px 15px;
  border-radius: 5px;
  font-weight: bold;
}

.board {
  background: #bbada0;
  padding: 10px;
  border-radius: 10px;
  display: grid;
  grid-template-columns: repeat(4, 80px);
  gap: 10px;
  touch-action: none;
}

.cell {
  width: 80px;
  height: 80px;
  background: #cdc1b4;
  border-radius: 5px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
  font-weight: bold;
  color: #776e65;
}

.cell[data-value="2"]   { background: #eee4da; }
.cell[data-value="4"]   { background: #ede0c8; }
.cell[data-value="8"]   { background: #f2b179; color:#fff; }
.cell[data-value="16"]  { background: #f59563; color:#fff; }
.cell[data-value="32"]  { background: #f67c5f; color:#fff; }
.cell[data-value="64"]  { background: #f65e3b; color:#fff; }
.cell[data-value="128"] { background: #edcf72; color:#fff; }
.cell[data-value="256"] { background: #edcc61; color:#fff; }
.cell[data-value="512"] { background: #edc850; color:#fff; }
.cell[data-value="1024"]{ background: #edc53f; color:#fff; }
.cell[data-value="2048"]{ background: #edc22e; color:#fff; }

.overlay {
  position: absolute;
  inset: 0;
  background: rgba(238,228,218,0.85);
  display: none;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  border-radius: 10px;
}

.overlay h1 {
  color: #776e65;
  margin-bottom: 15px;
}

.overlay button {
  padding: 10px 20px;
  border: none;
  background: #8f7a66;
  color: #fff;
  font-size: 16px;
  border-radius: 5px;
  cursor: pointer;
}
</style>
</head>

<body>
<div class="container">
  <div class="top-bar">
    <div class="title">2048</div>
    <div class="score" id="score">Score: 0</div>
  </div>

  <div class="board" id="board"></div>

  <div class="overlay" id="overlay">
    <h1 id="overlayText"></h1>
    <button onclick="restart()">Restart</button>
  </div>
</div>

<script>
const boardEl = document.getElementById("board");
const scoreEl = document.getElementById("score");
const overlay = document.getElementById("overlay");
const overlayText = document.getElementById("overlayText");

let board, score, won;

function init() {
  board = Array.from({length:4},()=>Array(4).fill(0));
  score = 0;
  won = false;
  overlay.style.display = "none";
  addRandom();
  addRandom();
  draw();
}

function draw() {
  boardEl.innerHTML = "";
  board.flat().forEach(v=>{
    const d=document.createElement("div");
    d.className="cell";
    if(v){
      d.textContent=v;
      d.dataset.value=v;
    }
    boardEl.appendChild(d);
  });
  scoreEl.textContent = "Score: " + score;
}

function addRandom() {
  const empty=[];
  board.forEach((r,i)=>r.forEach((v,j)=>v===0&&empty.push([i,j])));
  if(!empty.length) return;
  const [x,y]=empty[Math.floor(Math.random()*empty.length)];
  board[x][y]=Math.random()<0.9?2:4;
}

function slide(row){
  row=row.filter(v=>v);
  for(let i=0;i<row.length-1;i++){
    if(row[i]===row[i+1]){
      row[i]*=2;
      score+=row[i];
      if(row[i]===2048) win();
      row[i+1]=0;
    }
  }
  return row.filter(v=>v).concat(Array(4).fill(0)).slice(0,4);
}

function move(dir){
  const old=JSON.stringify(board);
  if(dir==="left") board=board.map(r=>slide(r));
  if(dir==="right") board=board.map(r=>slide(r.reverse()).reverse());
  if(dir==="up"){
    for(let c=0;c<4;c++){
      const col=slide(board.map(r=>r[c]));
      for(let r=0;r<4;r++) board[r][c]=col[r];
    }
  }
  if(dir==="down"){
    for(let c=0;c<4;c++){
      const col=slide(board.map(r=>r[c]).reverse()).reverse();
      for(let r=0;r<4;r++) board[r][c]=col[r];
    }
  }
  if(JSON.stringify(board)!==old){
    addRandom();
    draw();
    checkGameOver();
  }
}

function win(){
  if(!won){
    won=true;
    overlayText.textContent="You Win!";
    overlay.style.display="flex";
  }
}

function checkGameOver(){
  for(let r=0;r<4;r++)
    for(let c=0;c<4;c++){
      if(board[r][c]===0) return;
      if(c<3&&board[r][c]===board[r][c+1]) return;
      if(r<3&&board[r][c]===board[r+1][c]) return;
    }
  overlayText.textContent="Game Over";
  overlay.style.display="flex";
}

function restart(){ init(); }

document.addEventListener("keydown",e=>{
  if(e.key==="ArrowLeft")move("left");
  if(e.key==="ArrowRight")move("right");
  if(e.key==="ArrowUp")move("up");
  if(e.key==="ArrowDown")move("down");
});

let sx=0,sy=0;
boardEl.addEventListener("touchstart",e=>{
  sx=e.touches[0].clientX;
  sy=e.touches[0].clientY;
},{passive:true});

boardEl.addEventListener("touchend",e=>{
  const dx=e.changedTouches[0].clientX-sx;
  const dy=e.changedTouches[0].clientY-sy;
  if(Math.abs(dx)>Math.abs(dy)){
    if(dx>30)move("right");
    else if(dx<-30)move("left");
  } else {
    if(dy>30)move("down");
    else if(dy<-30)move("up");
  }
});

init();
</script>
</body>
</html>
