<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2048 – WebArcade</title>

<style>
/* ===== RESET ===== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
}

/* ===== THEME ===== */
:root {
  --bg1: #020617;
  --bg2: #1e293b;
  --card: #faf8ef;
  --text: #776e65;
}

@media (prefers-color-scheme: light) {
  :root {
    --bg1: #e0e7ff;
    --bg2: #f8fafc;
    --card: #faf8ef;
    --text: #776e65;
  }
}

/* ===== BODY BACKGROUND ===== */
body {
  min-height: 100vh;
  background:
    radial-gradient(circle at 20% 20%, rgba(99,102,241,0.25), transparent 40%),
    radial-gradient(circle at 80% 80%, rgba(34,197,94,0.25), transparent 40%),
    linear-gradient(135deg, var(--bg1), var(--bg2));
  display: flex;
  justify-content: center;
  align-items: center;
}

/* ===== GLASS WRAPPER ===== */
.scene {
  padding: 40px;
  border-radius: 28px;
  backdrop-filter: blur(16px);
  background: rgba(255,255,255,0.08);
  box-shadow: 0 40px 120px rgba(0,0,0,0.45);
}

/* ===== GAME CONTAINER ===== */
.container {
  text-align: center;
}

/* ===== TOP BAR ===== */
.top-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 14px;
}

.back-btn {
  background: none;
  border: none;
  color: var(--text);
  font-size: 16px;
  cursor: pointer;
}

.title {
  font-size: 32px;
  font-weight: 800;
  color: var(--text);
}

.score-box {
  display: flex;
  gap: 8px;
}

.score, .best {
  background: #bbada0;
  color: #fff;
  padding: 8px 12px;
  border-radius: 6px;
  font-weight: bold;
}

/* ===== BOARD ===== */
.board {
  background: #bbada0;
  padding: 12px;
  border-radius: 12px;
  display: grid;
  grid-template-columns: repeat(4, 80px);
  gap: 10px;
  touch-action: none;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.15);
}

/* ===== CELL ===== */
.cell {
  width: 80px;
  height: 80px;
  background: #cdc1b4;
  border-radius: 6px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 28px;
  font-weight: bold;
  color: #776e65;
  transition: transform 0.1s ease;
}

/* TILE COLORS */
.cell[data-value="2"] { background:#eee4da; }
.cell[data-value="4"] { background:#ede0c8; }
.cell[data-value="8"] { background:#f2b179;color:#fff; }
.cell[data-value="16"]{ background:#f59563;color:#fff; }
.cell[data-value="32"]{ background:#f67c5f;color:#fff; }
.cell[data-value="64"]{ background:#f65e3b;color:#fff; }
.cell[data-value="128"]{ background:#edcf72;color:#fff; }
.cell[data-value="256"]{ background:#edcc61;color:#fff; }
.cell[data-value="512"]{ background:#edc850;color:#fff; }
.cell[data-value="1024"]{ background:#edc53f;color:#fff; }
.cell[data-value="2048"]{ background:#edc22e;color:#fff; }

/* ===== OVERLAY ===== */
.overlay {
  position: absolute;
  inset: 0;
  background: rgba(250,248,239,0.92);
  display: none;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  border-radius: 12px;
}

.overlay h1 {
  color: #776e65;
  margin-bottom: 18px;
}

.overlay button {
  padding: 10px 22px;
  border: none;
  background: #8f7a66;
  color: #fff;
  font-size: 16px;
  border-radius: 6px;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="scene">
  <div class="container">
    <div class="top-bar">
      <button class="back-btn" onclick="location.href='blog.html'">← Back</button>
      <div class="title">2048</div>
      <div class="score-box">
        <div class="score" id="score">0</div>
        <div class="best" id="best">Best: 0</div>
      </div>
    </div>

    <div class="board" id="board"></div>

    <div class="overlay" id="overlay">
      <h1 id="overlayText"></h1>
      <button onclick="restart()">Restart</button>
    </div>
  </div>
</div>

<script>
const boardEl = document.getElementById("board");
const scoreEl = document.getElementById("score");
const bestEl = document.getElementById("best");
const overlay = document.getElementById("overlay");
const overlayText = document.getElementById("overlayText");

let board, score, won, blocked;
let best = localStorage.getItem("best2048") || 0;

function init() {
  board = Array.from({length:4},()=>Array(4).fill(0));
  score = 0;
  won = false;
  blocked = false;
  overlay.style.display = "none";
  addRandom(); addRandom();
  draw();
}

function draw() {
  boardEl.innerHTML = "";
  board.flat().forEach(v=>{
    const c=document.createElement("div");
    c.className="cell";
    if(v){
      c.textContent=v;
      c.dataset.value=v;
    }
    boardEl.appendChild(c);
  });
  scoreEl.textContent = score;
  bestEl.textContent = "Best: " + best;
}

function addRandom() {
  const empty=[];
  board.forEach((r,i)=>r.forEach((v,j)=>v===0&&empty.push([i,j])));
  if(!empty.length) return;
  const [x,y]=empty[Math.floor(Math.random()*empty.length)];
  board[x][y]=Math.random()<0.9?2:4;
}

function slide(row){
  row=row.filter(v=>v);
  for(let i=0;i<row.length-1;i++){
    if(row[i]===row[i+1]){
      row[i]*=2; score+=row[i];
      if(row[i]===2048) win();
      row[i+1]=0;
    }
  }
  return row.filter(v=>v).concat(Array(4).fill(0)).slice(0,4);
}

function move(dir){
  if(blocked) return;
  const old=JSON.stringify(board);
  if(dir==="left") board=board.map(r=>slide(r));
  if(dir==="right") board=board.map(r=>slide(r.reverse()).reverse());
  if(dir==="up"){
    for(let c=0;c<4;c++){
      const col=slide(board.map(r=>r[c]));
      for(let r=0;r<4;r++) board[r][c]=col[r];
    }
  }
  if(dir==="down"){
    for(let c=0;c<4;c++){
      const col=slide(board.map(r=>r[c]).reverse()).reverse();
      for(let r=0;r<4;r++) board[r][c]=col[r];
    }
  }
  if(JSON.stringify(board)!==old){
    addRandom(); draw(); checkGameOver();
    if(score>best){
      best=score;
      localStorage.setItem("best2048",best);
    }
  }
}

function win(){
  won=true; blocked=true;
  overlayText.textContent="You Win!";
  overlay.style.display="flex";
}

function checkGameOver(){
  for(let r=0;r<4;r++)
    for(let c=0;c<4;c++){
      if(board[r][c]===0) return;
      if(c<3&&board[r][c]===board[r][c+1]) return;
      if(r<3&&board[r][c]===board[r+1][c]) return;
    }
  blocked=true;
  overlayText.textContent="Game Over";
  overlay.style.display="flex";
}

function restart(){ init(); }

document.addEventListener("keydown",e=>{
  if(e.key==="ArrowLeft")move("left");
  if(e.key==="ArrowRight")move("right");
  if(e.key==="ArrowUp")move("up");
  if(e.key==="ArrowDown")move("down");
});

let sx=0,sy=0;
boardEl.addEventListener("touchstart",e=>{
  sx=e.touches[0].clientX;
  sy=e.touches[0].clientY;
},{passive:true});

boardEl.addEventListener("touchend",e=>{
  const dx=e.changedTouches[0].clientX-sx;
  const dy=e.changedTouches[0].clientY-sy;
  if(Math.abs(dx)>Math.abs(dy)){
    if(dx>30)move("right");
    else if(dx<-30)move("left");
  } else {
    if(dy>30)move("down");
    else if(dy<-30)move("up");
  }
});

init();
</script>
  <script type="module" src="js/auth.js"></script>

</body>
</html>
